(()=>{"use strict";var t;!function(t){t.ADD_TO_CART="ADD_TO_CART",t.GET_PRODUCTS="GET_PRODUCTS"}(t||(t={}));let e=(t=>{const e=localStorage.getItem(t)||sessionStorage.getItem(t);return e?JSON.parse(e):{screen:"DASHBOARD",cart:[],products:[]}})("STORE"),n=[];const i=i=>{const o=((e,n)=>{const{action:i,payload:o}=e;switch(i){case t.ADD_TO_CART:return Object.assign(Object.assign({},n),{cart:[...n.cart,o]});case t.GET_PRODUCTS:return Object.assign(Object.assign({},n),{products:o});default:return n}})(i,JSON.parse(JSON.stringify(e)));e=o,n.forEach((t=>t.render())),((t,e,n=!1)=>{const i=n?sessionStorage:localStorage,o=JSON.stringify(e);i.setItem(t,o)})("STORE",o)};const o=()=>{return t=void 0,e=void 0,i=function*(){try{const t=yield fetch("https://fakestoreapi.com/products").then((t=>t.json()));return console.log(t),t}catch(t){console.error(t)}},new((n=void 0)||(n=Promise))((function(o,r){function c(t){try{a(i.next(t))}catch(t){r(t)}}function s(t){try{a(i.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,s)}a((i=i.apply(t,e||[])).next())}));var t,e,n,i};var r,c;!function(t){t.uid="uid",t.image="image",t.title="title",t.description="description",t.category="category",t.price="price",t.rating="rating"}(r||(r={}));class s extends HTMLElement{static get observedAttributes(){return Object.values(r)}attributeChangedCallback(t,e,n){e===n&&(t===r.price||t===r.rating||t===r.uid?this[t]=n?Number(n):void 0:this[t]=n),this.render()}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e;if(!this.shadowRoot)return;this.shadowRoot.innerHTML=`\n            <link rel="stylesheet" href="../src/components/product/product.css">\n            <section>\n            <div  class="card">\n            <div id="character">\n            <img id="img" src="${this.image?this.image:"Not found"}">\n            <div class="text">\n            <h2 class="name">${this.title}</h2>\n            <p>Description: ${this.description}</p>\n            <p>Category: ${this.category}</p>\n            <p>Price: $${this.price}</p>\n            <p>Rating: ${this.rating}</p>\n            <button id="add-button">Agregar</button>\n            </div>\n            </div>\n</div>\n            \n            </section>\n            `;const n=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#add-button");null==n||n.addEventListener("click",(()=>{const e={uid:this.uid,image:this.image,description:this.description,category:this.category,price:this.price,rating:this.rating};var n;i((n=e,{action:t.ADD_TO_CART,payload:n}))}))}}customElements.define("card-product",s),function(t){t.uid="uid",t.utitle="utitle",t.price="price",t.image="image"}(c||(c={}));class a extends HTMLElement{static get observedAttributes(){return Object.keys(c)}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}attributeChangedCallback(t,e,n){t===c.uid?this.uid=n?Number(n):void 0:t===c.price?this.price=n?Number(n):void 0:this[t]=n,this.render()}render(){this.shadowRoot&&(this.shadowRoot.innerHTML=`<link rel="stylesheet" href="../src/components/shoppingcartitem/shoppingcartitem.css">\n            <section>\n            <div  class="card">\n            <div id="character">\n            <img id="img" src="${this.getAttribute("image")}">\n            <div class="text">\n            <h2 class="name">${this.getAttribute("utitle")}</h2>\n            <p>Price: $${this.getAttribute("price")}</p>\n            \n            <button id="add-button">Agregar</button>\n            </div>\n            </div>\n</div>\n            \n            </section>`)}}customElements.define("shoppingcart-component",a);class d extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),n=[...n,this]}connectedCallback(){return n=this,r=void 0,s=function*(){if(e.products&&0!==e.products.length)console.log("Products already loaded:",e.products);else{const a=yield(n=void 0,r=void 0,c=void 0,s=function*(){const e=yield o();return{action:t.GET_PRODUCTS,payload:e}},new(c||(c=Promise))((function(t,e){function i(t){try{a(s.next(t))}catch(t){e(t)}}function o(t){try{a(s.throw(t))}catch(t){e(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof c?n:new c((function(t){t(n)}))).then(i,o)}a((s=s.apply(n,r||[])).next())})));i(a),console.log("Products state after fetch:",e.products)}var n,r,c,s;this.render()},new((c=void 0)||(c=Promise))((function(t,e){function i(t){try{a(s.next(t))}catch(t){e(t)}}function o(t){try{a(s.throw(t))}catch(t){e(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof c?n:new c((function(t){t(n)}))).then(i,o)}a((s=s.apply(n,r||[])).next())}));var n,r,c,s}fetchProducts(){try{if(!e.products||0===e.products.length)return console.log("No products available in the state."),null;const t=this.ownerDocument.createElement("section");return t.className="products-container",e.products.forEach((e=>{const n=this.ownerDocument.createElement("product-component");n.setAttribute(r.uid,e.id.toString()),n.setAttribute(r.image,e.image),n.setAttribute(r.description,e.title),n.setAttribute(r.category,e.category),n.setAttribute(r.price,e.price.toString()),n.setAttribute(r.rating,e.rating.rate.toString()),t.appendChild(n)})),console.log("Products rendered:",e.products),t}catch(t){return console.error("Error rendering products:",t),null}}renderShoppingCart(){const t=this.ownerDocument.createElement("section");return t.className="cart-container",0===e.cart.length?t.innerHTML="<p>Your cart is empty</p>":e.cart.forEach((e=>{var n,i;const o=this.ownerDocument.createElement("cart-component");o.setAttribute(c.uid,(null===(n=e.uid)||void 0===n?void 0:n.toString())||""),o.setAttribute(c.utitle,e.description||""),o.setAttribute(c.price,(null===(i=e.price)||void 0===i?void 0:i.toString())||""),o.setAttribute(c.image,e.image||""),t.appendChild(o)})),t}render(){if(this.shadowRoot){this.shadowRoot.innerHTML="";const t=this.ownerDocument.createElement("h2");t.textContent="Product List",this.shadowRoot.appendChild(t);const e=this.fetchProducts();e?this.shadowRoot.appendChild(e):this.shadowRoot.innerHTML+="<p>no encontre los productos :( </p>";const n=this.ownerDocument.createElement("h2");n.textContent="Shopping Cart",this.shadowRoot.appendChild(n);const i=this.renderShoppingCart();i&&this.shadowRoot.appendChild(i)}}}customElements.define("app-dashboard",d);class u extends HTMLElement{constructor(){super(),this.dataApi=[],this.cards=[],this.attachShadow({mode:"open"})}connectedCallback(){return t=this,e=void 0,i=function*(){this.render(),this.dataApi=yield o(),this.createProduct()},new((n=void 0)||(n=Promise))((function(o,r){function c(t){try{a(i.next(t))}catch(t){r(t)}}function s(t){try{a(i.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,s)}a((i=i.apply(t,e||[])).next())}));var t,e,n,i}createProduct(){this.dataApi.forEach((t=>{var e,n;const i=this.ownerDocument.createElement("card-product");i.setAttribute(r.image,t.image),i.setAttribute(r.title,t.title),i.setAttribute(r.description,t.description),i.setAttribute(r.category,t.category),i.setAttribute(r.price,t.price),i.setAttribute(r.rating,t.rating.rate),console.log(t),null===(n=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".product-container"))||void 0===n||n.appendChild(i)}))}render(){var t;if(this.shadowRoot&&(this.shadowRoot.innerHTML=""),"DASHBOARD"===e.screen){const e=document.createElement("app-dashboard");null===(t=this.shadowRoot)||void 0===t||t.appendChild(e)}else console.log("Not found")}}customElements.define("app-container",u)})();